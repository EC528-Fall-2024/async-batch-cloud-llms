################### pub/sub local setup ####################
gcloud auth application-default login
export GOOGLE_APPLICATION_CREDENTIALS="/c/Users/rayan/AppData/Local/Packages/PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0/LocalCache/Roaming/gcloud/application_default_credentials.json"

############# push container to gcloud ###############
gcloud init
gcloud auth configure-docker
docker build -t rate-limiter-python-app .
docker tag rate-limiter-python-app gcr.io/elated-scope-437703-h9/rate-limiter-python-app
docker push gcr.io/elated-scope-437703-h9/rate-limiter-python-app


######################### deploy rate-limiter service whenever needed #################################
gcloud run deploy rate-limiter-python-app \
  --image gcr.io/elated-scope-437703-h9/rate-limiter-python-app \
  --platform managed \
  --region us-central1 \
  --allow-unauthenticated \
  --min-instances=1

# Revise the cloud run service to have "CPU is always allocated" enabled